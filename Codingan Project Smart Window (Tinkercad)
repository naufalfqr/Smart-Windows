#include <LiquidCrystal_I2C.h>
#include <Servo.h>

#define RS 7
#define E  6
#define D4 5
#define D5 4
#define D6 3
#define D7 2

LiquidCrystal lcd(RS, E, D4, D5, D6, D7);

byte degree[] = { 7, 5, 7, 0, 0, 0, 0, 0 };

#define sensorTMP36   A1

void setup() {
  Serial.begin(9600);
 
  pinMode(pinDC, OUTPUT); //Setting Inisialisasi Sensor Cahaya
 
  //Setting Inisialisasi Sensor Suhu & Output Ke LCD
  lcd.begin(16, 2);
  lcd.createChar(0, degree);
  lcd.clear();
  lcd.print("Temperature");
  delay(5000);
  delline(1);
 
  myservo.attach(9); //Setting Inisialisasi Servo
}

void setup() {

}
//Rumus Hitung Deajat Celcius
float fmap(long x, long in_min, long in_max, long out_min, long out_max) {
  return (float)(x - in_min) * (out_max - out_min) / (float)(in_max - in_min) + out_min;
}

void delline(int line) {
  lcd.setCursor(0, line);
  lcd.setCursor(0, line);
}


void loop() {
  //Proses Sensor Cahaya
  int nilaiSensor;
  nilaiSensor = analogRead(sensorLDR);
 
  if(nilaiSensor <=200){
    digitalWrite(pinDC, HIGH);
  }else{
    digitalWrite(pinDC, LOW);
  }
  delay(1000);
 
  //Proses Sensor Suhu
  float C = fmap(((analogRead(sensorTMP36) - 20 ) * 3.04), 0, 1023, -40, 125);
  Temperature(C);
 
  //Proses Output ke LCD
  float Celsius    = C;
  lcd.setCursor(4, 1);
  delay(250); delline(1);
  lcd.print(Celsius);
  lcd.write((byte)0); lcd.print("C  ");
  lcd.setCursor(9, 1); lcd.print(msg);
  delay(100); delline(1);
 
  //Proses Setting Servo setelah baca Suhu
  value = analogRead(A1);
  angle = map(value, 0, 50, 0, 180);
  Serial.println(angle);
  if (value >= 25){
    myservo.write(angle);                
    delay(15);
  }
}
